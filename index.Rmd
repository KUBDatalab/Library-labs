---
title: Library Labs - the map!
output: 
  html_document: 
    include-in-header:
      - header.html
htmlwidgets: TRUE
always_allow_html: true
---

What it says on the tin. Our boss wanted us to map potential collaborators, 
or do an analysis of the ecosystem of labs in libraries. This is it!

[Contribute?](contribute.html)


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("rmd_config.R")
library(jsonlite)
library(tidyverse)
library(knitr)
library(leaflet)
library(htmltools)
```

dette er index.rmd


```{r læsfiler, echo = F}
json_files <- list.files(path = "data/", full.names = T)

json_files <- json_files[json_files != "data/template.json"]
json_files
```

```{r hent data, echo = F}
data <- json_files %>% map_dfr(fromJSON)  %>% 
  unnest(c("name", "type", "Description", "link", "Institution"))
```


første forsøg på et kort!

```{r kort}
data %>% 
  select(name, coordinates) %>% 
  unnest(c(name, coordinates)) %>% 
  unnest(c(lat, lon)) %>% 
  rename(lng = lon) %>% 
  select(lng, lat, name) %>% 
  leaflet() %>% 
  addTiles() %>% 
  addMarkers(popup = ~htmlEscape(name))

```
## Kontakt mails

```{r}
data %>% 
  select(name, `Contact email`) %>% 
  unnest(`Contact email`) %>% 
  kable()
```
## Aktivitetskalendere
Ja, det skal gøres linkbart. Smid et issue i repoet, så kommer det nok.
```{r}
data %>% 
  select(name, `Activity calendar`) %>% 
  unnest(`Activity calendar`) %>% 
  kable()
```

